# @package _global_

# to execute this experiment run:
# python src/train.py experiment=vit_base_16

# 实验任务类型和标签
#log路径：${paths.log_dir}/${task_name}/runs/${tags[0]}_${tags[1]} ${now:%Y-%m-%d} ${now:%H-%M-%S}
task_name: "train"
tags: ["vit_base_16", "${data.train_val_test_split[0]}", "probe"]
# experiment_name: "vit_base_16"

# 随机种子
seed: 42

# 覆盖默认配置
defaults:
  - override /data: my_dataset
  - override /model: vit_base_16
  - override /callbacks: default
  - override /trainer: gpu
  - override /logger: tensorboard

# 训练配置
train: true
test: true
# 检查点路径
ckpt_path: null



data: 
  train_val_test_split: [0.20, 0.1, 0.1]
# 训练器配置
trainer:
  # 最大训练轮数
  max_epochs: 30
  
  # 最小训练轮数
  min_epochs: 5
  
  # 梯度裁剪值
  gradient_clip_val: 0.5
  
  # 验证间隔
  val_check_interval: 1.0  # 每训练1个epoch进行一次验证
  
  # 梯度累积步数
  accumulate_grad_batches: 1
  
  # 确定性训练
  deterministic: false

# 回调配置
callbacks:
  # 模型检查点配置
  model_checkpoint:
    monitor: "val/loss"
    mode: "min"
    save_top_k: 1
    save_last: true
    filename: "{model_name}-{epoch:02d}-{val/loss:.4f}"
  
  # 早停配置
  early_stopping:
    monitor: "val/loss"
    mode: "min"
    patience: 5
    verbose: true

# 日志配置
logger:
  tensorboard:
    name: "vit_base_16_experiment"


